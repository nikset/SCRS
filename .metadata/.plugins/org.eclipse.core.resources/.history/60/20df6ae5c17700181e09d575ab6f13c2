package com.iljavarolo.spring;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;

import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;

import com.bea.common.security.xacml.IOException;

@Controller
public class HelloWorldController {

@RequestMapping(value = "/hello")
public String hello(@RequestParam(value="msg", required=false, defaultValue="Hello World") String msg, Model model) {

model.addAttribute("msg", msg);

return "helloworld";

}

@RequestMapping(value = "/autenticazione")
public String autenticazione(@RequestParam(value="msg", required=false, defaultValue="Hello World") String msg, Model model) {

model.addAttribute("msg", msg);

return "authentication";

}


@RequestMapping(value = "/welcome", method = RequestMethod.GET) 
	public String welcome( ) {		
		        System.out.println("Application Startup Welcome Page");		
		        return "welcome";		
		    }

@RequestMapping(value = "/redirect_page", method = RequestMethod.GET)
    public String redirect(@RequestParam("userName")String name, @RequestParam("password")String password) {
        System.out.println("Redirecting Result To The Final Page");
        
        
        System.out.println(name);
        System.out.println(password);
        
        return "redirect:final_page";
    }


//passiamo i parametri alla final Page per poterli visualizzare
@RequestMapping(value = "/final_page", method = RequestMethod.GET)
 public String finalPage() {
        System.out.println("Showing The Redirected Page");
        

        return "final";
    }



@RequestMapping(value = "/authentication", method = RequestMethod.GET) 
public String authentication( ) {		
	        System.out.println("Application Startup Welcome Page");		
	        return "authentication_page";		
	    }





@RequestMapping(value = "/controllo_credenziali", method = RequestMethod.GET)
public String controllo_credenziali(@RequestParam("userName")String name, @RequestParam("password")String password) throws FileNotFoundException {
    System.out.println("Redirecting Result To The Final Page");
    
    
    newFile();
    
    
    System.out.println(name);
    System.out.println(password);
    
    return "redirect:final_page";
}

public static void newFile() {
	 
    String path = "/credenziali.txt";
 
    File file = new File(path);
	 
	if (file.exists())
	    System.out.println("Il file " + path + " esiste");
	else
		try {
			if (file.createNewFile())
			    System.out.println("Il file " + path + " è stato creato");
			else
			    System.out.println("Il file " + path + " non può essere creato");
		} catch (java.io.IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
}







}